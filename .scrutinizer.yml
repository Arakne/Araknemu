build:
    nodes:
        analysis:
          dependencies:
            override:
              - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -Dcheckstyle.skip -B -V
        tests:
            environment:
                java: 'java-8-oracle'
                timezone: Europe/Paris

            services:
                mysql: 5.7

            dependencies:
              override:
                - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -Dcheckstyle.skip -B -V

            tests:
                override:
                    - command: mysql -u root -e "create database araknemu"
                    - command: mysql -u root -e "create user araknemu"
                    - command: mysql -u root -e "grant all privileges on araknemu.* to araknemu"
                    - command: mvn test
                      coverage:
                        file: 'target/site/jacoco/jacoco.xml'
                        format: 'jacoco'
                    - command: 'mvn checkstyle:checkstyle'
                      analysis:
                        file: 'target/checkstyle-result.xml'
                        format: 'general-checkstyle'
